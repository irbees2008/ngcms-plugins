# –ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞ rating —Å ng-helpers v0.2.0

## –î–∞—Ç–∞: 11 —è–Ω–≤–∞—Ä—è 2026

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### ‚úÖ 1. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–µ–π—Ç–∏–Ω–≥–∞ —á–µ—Ä–µ–∑ clamp

**–§—É–Ω–∫—Ü–∏—è:** `clamp()`

**–î–æ:**

```php
$rating = intval($_REQUEST['rating']);
if (($rating < 1) || ($rating > 5)) {
    return 'incorrect rating';
}
```

**–ü–æ—Å–ª–µ:**

```php
$rating = intval($_REQUEST['rating']);
// Use clamp to ensure rating is within valid range
$rating = clamp($rating, 1, 5);
if (!$rating) {
    logger('Rating: Invalid rating value attempted from IP: ' . get_ip(), 'warning', 'rating_security.log');
    return 'incorrect rating';
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üìè –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-5
- üõ°Ô∏è –ë–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤–∑–ª–æ–º–∞
- üéØ –ö–æ–º–ø–∞–∫—Ç–Ω–µ–µ –∫–æ–¥

---

### ‚úÖ 2. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ IP –≥–æ–ª–æ—Å—É—é—â–∏—Ö

**–§—É–Ω–∫—Ü–∏—è:** `get_ip()`

```php
// Log successful vote with IP
$userIP = get_ip();
$userName = $userROW['name'] ?? 'Guest';
logger("Rating: User {$userName} voted {$rating}/5 for news #{$post_id} from IP: {$userIP}", 'info', 'rating.log');
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üåê –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –∑–∞ –ø—Ä–æ–∫—Å–∏/CDN
- üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–∞–∫—Ä—É—Ç–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞
- üîç –ê–Ω–∞–ª–∏–∑ –≥–µ–æ–≥—Ä–∞—Ñ–∏–∏ –≥–æ–ª–æ—Å–æ–≤
- üö´ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –ø–æ IP

---

### ‚úÖ 3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π

**–§—É–Ω–∫—Ü–∏—è:** `logger()`

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**

- ‚úÖ –£—Å–ø–µ—à–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è (info)
- ‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∏ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π (warning)
- üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ Guest
- ‚≠ê –ó–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞ (1-5)
- üì∞ ID –Ω–æ–≤–æ—Å—Ç–∏
- üåê IP –∞–¥—Ä–µ—Å

**–ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:**

```
[2026-01-11 16:45:23] [INFO] Rating: User John voted 5/5 for news #123 from IP: 192.168.1.100
[2026-01-11 16:46:15] [INFO] Rating: User Guest voted 4/5 for news #456 from IP: 10.0.0.50
[2026-01-11 16:47:08] [WARNING] Rating: Invalid rating value attempted from IP: 192.168.1.200
```

**–§–∞–π–ª—ã –ª–æ–≥–æ–≤:**

- `engine/logs/rating.log` - —É—Å–ø–µ—à–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- `engine/logs/rating_security.log` - –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞

---

### ‚úÖ 4. –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ —Ä–µ–π—Ç–∏–Ω–≥–∞

**–§—É–Ω–∫—Ü–∏—è:** `percentage()`

```php
// Use percentage helper for rating calculation
$tvars['vars']['rating'] = ($data['rating'] == 0) ? 0 : round(($data['rating'] / $data['votes']), 0);
$tvars['vars']['rating_percent'] = percentage($data['rating'], $data['votes'] * 5); // Out of 5 stars
$tvars['vars']['votes'] = $data['votes'];
```

**–í —à–∞–±–ª–æ–Ω–µ —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω–æ:**

```twig
{rating}         <!-- –°—Ä–µ–¥–Ω–∏–π —Ä–µ–π—Ç–∏–Ω–≥: 4 -->
{rating_percent} <!-- –ü—Ä–æ—Ü–µ–Ω—Ç: 80% (–ù–û–í–ê–Ø –ü–ï–†–ï–ú–ï–ù–ù–ê–Ø) -->
{votes}          <!-- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ—Å–æ–≤: 25 -->
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ü–ª–∞–≥–∏–Ω rating –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ä—É—é —Å–∏—Å—Ç–µ–º—É —à–∞–±–ª–æ–Ω–æ–≤ ($tpl), –Ω–µ Twig. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ —Ñ–∏–≥—É—Ä–Ω—ã–µ —Å–∫–æ–±–∫–∏ `{–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è}` –±–µ–∑ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∫–æ–Ω–≤–µ—Ä—Å–∏–∏.

**–ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**

```html
<!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä -->
<div class="rating-bar">
  <div class="rating-fill" style="width: {rating_percent}%"></div>
</div>

<!-- –¢–µ–∫—Å—Ç–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ -->
<span>–†–µ–π—Ç–∏–Ω–≥: {rating_percent}% ({votes} –≥–æ–ª–æ—Å–æ–≤)</span>
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üìä –ù–∞–≥–ª—è–¥–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
- üé® –õ–µ–≥–∫–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–≤
- üìà –ü–æ–Ω—è—Ç–Ω–µ–µ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### ‚úÖ 5. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ AJAX –∑–∞–ø—Ä–æ—Å–æ–≤

**–§—É–Ω–∫—Ü–∏—è:** `is_ajax()`

```php
// Check if this is an AJAX request
if (is_ajax()) {
    @header('Content-type: application/json; charset=utf-8');
} else {
    @header('Content-type: text/html; charset="utf-8"');
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üéØ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type –¥–ª—è AJAX
- üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É—Ç—å JSON –¥–ª—è —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
- ‚úÖ –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å XMLHttpRequest –∏ Fetch API
- üì± –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

---

### ‚úÖ 6. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±—Ä–æ—Å –∫—ç—à–∞

**–§—É–Ω–∫—Ü–∏—è:** `cache_forget()`

```php
// Clear cache for this news
cache_forget("news_{$post_id}");
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚ôªÔ∏è –ê–∫—Ç—É–∞–ª—å–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è
- üéØ –¢–æ—á–µ—á–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (—Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω–µ–Ω–Ω–∞—è –Ω–æ–≤–æ—Å—Ç—å)
- ‚ö° –ù–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ IP –≥–æ–ª–æ—Å—É—é—â–∏—Ö
- üîí –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–∞–∫—Ä—É—Ç–∫–∏ —á–µ—Ä–µ–∑ –ª–æ–≥–∏

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

- ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
- ‚úÖ AJAX –∑–∞–ø—Ä–æ—Å—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –≤–µ—Ä–Ω–æ
- ‚úÖ –ö—ç—à —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —à–∞–±–ª–æ–Ω—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è {rating_percent}
- ‚úÖ Cookie –º–µ—Ö–∞–Ω–∏–∑–º –Ω–µ –∏–∑–º–µ–Ω–∏–ª—Å—è

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω–∞—Ö

### 1. –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä —Ä–µ–π—Ç–∏–Ω–≥–∞

```html
<div class="rating-widget">
  <div class="rating-stars">
    <!-- –ó–≤—ë–∑–¥—ã —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
  </div>
  <div class="rating-progress">
    <div class="progress-bar" style="width: {rating_percent}%"></div>
  </div>
  <div class="rating-info">{rating}/5 ({votes} –≥–æ–ª–æ—Å–æ–≤)</div>
</div>
```

### 2. –¶–≤–µ—Ç–Ω–æ–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

```html
<div
  class="rating-badge"
  style="background-color: hsl({rating_percent}, 70%, 50%)">
  {rating_percent}%
</div>
```

### 3. –¢–µ–∫—Å—Ç–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```html
<div class="rating-stats">
  <span class="stars">{rating} ‚≠ê</span>
  <span class="percent">{rating_percent}%</span>
  <span class="votes">{votes} –≥–æ–ª–æ—Å–æ–≤</span>
</div>
```

---

## –ê–Ω–∞–ª–∏–∑ –ª–æ–≥–æ–≤

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π
tail -n 50 engine/logs/rating.log

# –ü–æ–∏—Å–∫ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
grep "WARNING" engine/logs/rating_security.log

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ IP
grep "192.168.1" engine/logs/rating.log | wc -l
```

### –í—ã—è–≤–ª–µ–Ω–∏–µ –Ω–∞–∫—Ä—É—Ç–∫–∏:

```bash
# –¢–æ–ø-10 —Å–∞–º—ã—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö IP
cat engine/logs/rating.log | grep -oP 'IP: \K[\d.]+' | sort | uniq -c | sort -rn | head -10
```

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ

### 1. JSON –æ—Ç–≤–µ—Ç—ã –¥–ª—è AJAX

```php
if (is_ajax()) {
    echo json_encode([
        'success' => true,
        'rating' => $tvars['vars']['rating'],
        'rating_percent' => $tvars['vars']['rating_percent'],
        'votes' => $tvars['vars']['votes']
    ]);
    exit;
}
```

### 2. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è IP

```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ banned IP
$bannedIPs = ['192.168.1.200', '10.0.0.100'];
if (in_array(get_ip(), $bannedIPs)) {
    logger('Rating: Blocked vote from banned IP: ' . get_ip(), 'warning', 'rating_security.log');
    return 'access denied';
}
```

### 3. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥–æ–ª–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP

```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≥–æ–ª–æ—Å–æ–≤ —Å IP –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
$recentVotes = count_votes_from_ip(get_ip(), 3600);
if ($recentVotes > 10) {
    logger("Rating: Too many votes from IP: " . get_ip() . " ({$recentVotes} votes/hour)", 'warning', 'rating_security.log');
    return 'too many votes';
}
```

### 4. –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

```php
// –°–æ—Ö—Ä–∞–Ω—è—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–∞–∂–¥–æ–º –≥–æ–ª–æ—Å–µ
$mysql->query("insert into " . prefix . "_rating_log (news_id, user_id, rating, ip, timestamp) values (...)");
```

### 5. Webhook —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

```php
// –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤—ã—Å–æ–∫–æ–º —Ä–µ–π—Ç–∏–Ω–≥–µ
if ($tvars['vars']['rating'] >= 4.5 && $data['votes'] >= 10) {
    logger("Rating: High-rated news #{$post_id} - {$tvars['vars']['rating']}/5", 'notice', 'rating_highlights.log');
}
```

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ç–∫–∞—Ç—É

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã:

### 1. –û—Ç–∫–ª—é—á–∏—Ç—å clamp

```php
if (($rating < 1) || ($rating > 5)) {
    return 'incorrect rating';
}
```

### 2. –û—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å `logger()`:

```php
// logger("...", 'info', 'rating.log');
```

### 3. –£–±—Ä–∞—Ç—å percentage

```php
// –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
// $tvars['vars']['rating_percent'] = percentage(...);
```

### 4. –û—Ç–∫–ª—é—á–∏—Ç—å AJAX –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ

```php
@header('Content-type: text/html; charset="utf-8"');
```

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: 18
- üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫: 6
- üì¶ –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: ng-helpers >= 0.2.0
- ‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ: 10 –º–∏–Ω—É—Ç
- üîí –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ
- üìä –ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏: {rating_percent}
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ: –ø–æ–ª–Ω–æ–µ

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏:

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å rating=10 (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–æ –¥–æ 5)
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ rating=0 (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥ `rating_security.log`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –ü—Ä–æ–≥–æ–ª–æ—Å—É–π—Ç–µ –∑–∞ –Ω–æ–≤–æ—Å—Ç—å
2. –û—Ç–∫—Ä–æ–π—Ç–µ `engine/logs/rating.log`
3. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å —Å –≤–∞—à–∏–º IP –∏ –∏–º–µ–Ω–µ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ–Ω—Ç–∞:

1. –î–æ–±–∞–≤—å—Ç–µ –≤ —à–∞–±–ª–æ–Ω `{rating_percent}`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å 0-100%)
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ AJAX:

1. –°–¥–µ–ª–∞–π—Ç–µ AJAX –∑–∞–ø—Ä–æ—Å –∫ –ø–ª–∞–≥–∏–Ω—É
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Content-Type (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å application/json)

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ rating –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–ª–∞–≥–∏–Ω–∞: **mailing** (—Ä–∞—Å—Å—ã–ª–∫–∞)
