# –ú–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏—è –ø–ª–∞–≥–∏–Ω–∞ feedback —Å ng-helpers v0.2.0

## –î–∞—Ç–∞: 11 —è–Ω–≤–∞—Ä—è 2026

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### ‚úÖ 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ CSRF –∑–∞—â–∏—Ç–∞

**–§—É–Ω–∫—Ü–∏–∏:** `csrf_field()`, `validate_csrf()`

**–í —Ñ–æ—Ä–º–µ (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è):**

```php
// Add CSRF protection
$hF .= csrf_field();
$tVars['hidden_fields'] = $hF;
```

**–ü—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ:**

```php
// Validate CSRF token
if (!validate_csrf()) {
    logger('CSRF validation failed from IP: ' . get_ip(), 'warning', 'feedback_security.log');
    http_response_code(403);
    die('CSRF validation failed');
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üîí –ó–∞—â–∏—Ç–∞ –æ—Ç CSRF –∞—Ç–∞–∫
- üõ°Ô∏è –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–æ–¥–¥–µ–ª–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤–∑–ª–æ–º–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞

---

### ‚úÖ 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–µ—Ç–æ–¥–∞ POST

**–§—É–Ω–∫—Ü–∏—è:** `is_post()`

```php
// Check if request method is POST
if (!is_post()) {
    return;
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úã –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ GET –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫—É —Ñ–æ—Ä–º—ã
- üéØ –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

---

### ‚úÖ 3. –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è email

**–§—É–Ω–∫—Ü–∏—è:** `validate_email()`

**–î–æ:**

```php
if ((filter_var($fieldValues[$fName], FILTER_VALIDATE_EMAIL) !== false) && file_exists($tfn)) {
```

**–ü–æ—Å–ª–µ:**

```php
// Use ng-helpers email validation
if (validate_email($fieldValues[$fName]) && file_exists($tfn)) {
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- ‚úÖ –ë–æ–ª–µ–µ —Å—Ç—Ä–æ–≥–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ email
- üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤
- üö´ –û—Ç—Å–µ–∫–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

---

### ‚úÖ 4. –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

**–§—É–Ω–∫—Ü–∏—è:** `sanitize()`

```php
// Sanitize field value for security
$fieldValue = sanitize($fieldValue);
$fieldValues[$fName] = str_replace("\n", "<br/>\n", secure_html($fieldValue));
```

**–ó–∞—â–∏—Ç–∞ –æ—Ç:**

- üõ°Ô∏è XSS –∞—Ç–∞–∫
- üíâ SQL –∏–Ω—ä–µ–∫—Ü–∏–π
- üìù HTML —Ç–µ–≥–æ–≤ –≤ –ø–æ–ª—è—Ö
- üö´ –û–ø–∞—Å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤

---

### ‚úÖ 5. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–æ–∫ —Ñ–æ—Ä–º

**–§—É–Ω–∫—Ü–∏–∏:** `logger()`, `get_ip()`

```php
// Log successful form submission
$userIP = get_ip();
$userName = $userROW['name'] ?? 'Guest';
logger("Feedback form #{$form_id} '{$frow['title']}' submitted by {$userName} from IP: {$userIP}. Sent to {$mailCount} recipients.", 'info', 'feedback.log');
```

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**

- üìã ID –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ñ–æ—Ä–º—ã
- üë§ –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∏–ª–∏ Guest)
- üåê IP –∞–¥—Ä–µ—Å –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è
- ‚úâÔ∏è –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—É—á–∞—Ç–µ–ª–µ–π
- ‚ö†Ô∏è –ü–æ–ø—ã—Ç–∫–∏ CSRF –∞—Ç–∞–∫

**–§–∞–π–ª—ã –ª–æ–≥–æ–≤:**

- `engine/logs/feedback.log` - —É—Å–ø–µ—à–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
- `engine/logs/feedback_security.log` - –ø–æ–ø—ã—Ç–∫–∏ –≤–∑–ª–æ–º–∞

---

### ‚úÖ 6. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ IP –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è

**–§—É–Ω–∫—Ü–∏—è:** `get_ip()`

```php
$userIP = get_ip();
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**

- üåê –ü—Ä–∞–≤–∏–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç IP –∑–∞ –ø—Ä–æ–∫—Å–∏/CDN
- üìä –£—á–∏—Ç—ã–≤–∞–µ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∏ X-Forwarded-For, X-Real-IP
- üîç –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è —Å–ø–∞–º–∞

---

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ CSRF –∑–∞—â–∏—Ç–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ XSS —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–∞
- ‚úÖ POST-only –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ (< 1ms –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é)
- Overhead –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π

### –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–æ—Ä–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ –®–∞–±–ª–æ–Ω—ã –Ω–µ —Ç—Ä–µ–±—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –§–∏–ª—å—Ç—Ä—ã –ø–ª–∞–≥–∏–Ω–æ–≤ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ –±—É–¥—É—â–µ–º:

1. **validate_phone()** - –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–Ω—ã—Ö –ø–æ–ª–µ–π:

```php
if ($fInfo['type'] == 'phone' && !validate_phone($fieldValue)) {
    plugin_feedback_showScreen(1, '–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞');
    return;
}
```

2. **benchmark()** - –∑–∞–º–µ—Ä –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏:

```php
$result = benchmark(function() use ($fData) {
    return processFormData($fData);
});
logger("Form processed in {$result['time']}s", 'debug', 'feedback_performance.log');
```

3. **cache_get/put()** - –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ñ–æ—Ä–º—ã:

```php
$cacheKey = "feedback_form_{$form_id}";
if ($frow = cache_get($cacheKey)) {
    return $frow;
}
$frow = $mysql->record('select * from ...');
cache_put($cacheKey, $frow, 10);
```

4. **encrypt()/decrypt()** - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö:

```php
// –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
$encrypted = encrypt(json_encode($fieldValues));
```

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —à–∞–±–ª–æ–Ω–∞—Ö

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ CSRF –∑–∞—â–∏—Ç—ã (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

CSRF —Ç–æ–∫–µ–Ω –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Å–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `{{ hidden_fields }}`.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –∞–¥–º–∏–Ω–∫–µ

–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
tail -f engine/logs/feedback.log
tail -f engine/logs/feedback_security.log
```

–ò–ª–∏ —á–µ—Ä–µ–∑ –ø–ª–∞–≥–∏–Ω xsyslog (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω).

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –æ—Ç–∫–∞—Ç—É

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–Ω—É—Ç –ø—Ä–æ–±–ª–µ–º—ã:

1. **–û—Ç–∫–ª—é—á–∏—Ç—å CSRF** - –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å `validate_csrf()` –∏ `csrf_field()`
2. **–û—Ç–∫–ª—é—á–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - –∑–∞–∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å `logger()`
3. **–í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ä—É—é –≤–∞–ª–∏–¥–∞—Ü–∏—é email** - –∑–∞–º–µ–Ω–∏—Ç—å `validate_email()` –Ω–∞ `filter_var()`

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

- ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–æ —Å—Ç—Ä–æ–∫: 28
- üîÑ –ò–∑–º–µ–Ω–µ–Ω–æ —Å—Ç—Ä–æ–∫: 6
- üì¶ –ù–æ–≤—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: ng-helpers >= 0.2.0
- ‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ: 10 –º–∏–Ω—É—Ç
- üîí –£–ª—É—á—à–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏: –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ
- üìä Overhead –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: < 1ms

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ CSRF –∑–∞—â–∏—Ç—ã:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–æ—Ä–º—É –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
2. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ HTML —Ñ–æ—Ä–º—É
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Å –¥—Ä—É–≥–æ–≥–æ –¥–æ–º–µ–Ω–∞
4. –î–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—å—Å—è –æ—à–∏–±–∫–∞ 403

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

1. –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ä–º—É
2. –û—Ç–∫—Ä–æ–π—Ç–µ `engine/logs/feedback.log`
3. –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø–∏—Å—å —Å IP –∏ –≤—Ä–µ–º–µ–Ω–µ–º

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏:

1. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤–≤–µ—Å—Ç–∏ `<script>alert(1)</script>` –≤ –ø–æ–ª–µ
2. –ü–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ email
3. –°–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω

---

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

–ü–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ feedback –º–æ–∂–Ω–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –∫ –º–æ–¥–µ—Ä–Ω–∏–∑–∞—Ü–∏–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–ª–∞–≥–∏–Ω–∞: **lastcomments**
